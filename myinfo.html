<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<link rel="stylesheet" href="css/amazeui.min.css" tppabs="http://yanshi.sucaihuo.com/modals/16/1608/demo/css/amazeui.min.css" type="text/css" />
		<link rel="stylesheet" href="css/style.css" tppabs="http://yanshi.sucaihuo.com/modals/16/1608/demo/css/style.css" type="text/css" />
	</head>
	<body>
		 <header data-am-widget="header" class="am-header am-header-default jz">
		      <div class="am-header-left am-header-nav">
		         <a href="javascript:history.back()" class="">
					<i class="am-icon-chevron-left"></i>
				</a>
		      </div>
		      <h1 class="am-header-title">
		          <a href="#title-link" class="">我的资料</a>
		      </h1>
        </header>
        <div class="logo"><img id="myimg" src="images/tx.png" style="width:100px;height:100px;border-radius: 100%;"/></div>
        <div class="logotext">
        	<h2 id="name">名称</h2>
        	<p id="myname">酒店简称</p>
        </div>
        <div class="about">
	        	<form id="infos">
	        		<div class="wxdy">
		        		<span>酒店简称</span>
		        		<input style="padding-left: 10px;font-size: 14px;" id="jc" name="hotelName"></em>
		        	</div>
		        	<div class="wxdy">
		        		<span>酒店全称</span>
		        		<input style="padding-left: 10px;font-size: 14px;"  id="qc" name="hotelSinName"></em>
		        	</div>
		        	<div class="wxdy">
		        		<span>负责人</span>
		        		<input style="padding-left: 10px;font-size: 14px;"  id="fzr" name="name"></em>
		        	</div>
		        	<div class="wxdy">
		        		<span>酒店热线</span>
		        		<input style="padding-left: 10px;font-size: 14px;"  id="rx" name="tel"></em>
		        	</div>
		        	<div class="wxdy">
		        		<span>联系方式</span>
		        		<input style="padding-left: 10px;font-size: 14px;"  id="lxfs" name="phone"></em>
		        	</div>
		        	<div class="intro" >
		        		<textarea id="bz" style="width: 100%;height: 100px;border: none;" name="remark"></textarea>
		        	</div>
		        	<input type="hidden" name="id" id="id"/>
	        	</form>
        		</div>
        		<input type="button" value="修改资料" class="money-btn" >
			<div style="height: 55px;"></div>
	    <input type="file" name="file" style="display: none" id="file" onchange="getImg();" accept="image/*;capture=camera"/>
	</body>
	<script type="text/javascript" src="js/jquery.min.js" tppabs="http://yanshi.sucaihuo.com/modals/16/1608/demo/js/jquery.min.js" ></script>
	<script type="text/javascript" src="js/ajaxfileupload.js"></script>
	<script type="text/javascript" src="js/amazeui.min.js" tppabs="http://yanshi.sucaihuo.com/modals/16/1608/demo/js/amazeui.min.js"></script>
	<script type="text/javascript" src="js/hui.js"></script>
	<script>
		var id = localStorage.getItem("id");
		if(!id){
			location.href="login.html";
		}else{
			refush(id);
		}
		$("#myimg").click(function(){
			$("#file").click();
		});
		function getImg(){
			$.ajaxFileUpload({  
		        url : rootpath+"/businessMan/updateImg?id="+id,
		        secureuri : false, //一般设置为false  
		        fileElementId : 'file', //文件上传空间的id属性  <input type="file" id="file" name="file" />  
		        type : 'post',  
		        dataType : 'json', //返回值类型 一般设置为json  
		        success : function(data, status){
			        	if(status=="success"){
			        		hui.toast('修改成功', 1000);
			        		refush(id);
			        	}
		        },  
		        error : function(data, status, e){  
		        	hui.toast('修改失败，服务器繁忙', 1000);
		        }  
		    });  
		}
		function refush(id){
			hui.getJSON(
			    rootpath+'/businessMan/findBusinessMan/'+id,
			    function(msg){
			    	console.log(msg);
			    	$("#id").html(msg.id);
			    	$("#myname").html(msg.hotelSinName);
			    	$("#name").html(msg.name);
			    	$("#jc").val(msg.hotelSinName);
			    	$("#qc").val(msg.hotelName);
			    	$("#fzr").val(msg.name);
			    	$("#lxfs").val(msg.phone);
			    	$("#bz").val(msg.remark);
			    	$("#rx").val(msg.tel);
			    	if(msg.faceImg){
                      if(msg.faceImg.indexOf("http")>-1){
                          document.getElementById("myimg").src=msg.faceImg;
                      }else{
                          document.getElementById("myimg").src=rootpath+"/"+msg.faceImg;
                      }
                    }
			    },
			    function(e){
			        hui.iconToast('读取消息失败', 'warn');
			        console.log(e);
			    }
			);
		}
		$(".money-btn").click(function(){
			hui.postJSON(
			    rootpath+'/businessMan/businessManUpdateSave',
			    $("#infos").serialize(),
			    function(msg){
				    hui.toast(msg.message, 1000);
			    },
			    function(e){
			        hui.iconToast('读取消息失败', 'warn');
			        console.log(e);
			    }
			);
		});		
	</script>
</html>
